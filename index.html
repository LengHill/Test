<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú—ñ–π –§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –¢—Ä–µ–∫–µ—Ä</title>
    
    <!-- PWA —Ç–∞ –ú–∞–Ω—ñ—Ñ–µ—Å—Ç -->
    <link rel="manifest" href="./finance_manifest.json">
    <meta name="theme-color" content="#4F46E5">

    <!-- CDN –¥–ª—è React, Babel —Ç–∞ Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* –°—Ç–∏–ª—ñ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç—É */
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, useRef } = React;
        
        // --- –ö–û–ù–°–¢–ê–ù–¢–ò –¢–ê –ü–ï–†–ï–ö–õ–ê–î–ò ---

        const LOCAL_STORAGE_KEY = 'localFinanceTrackerData_v2'; // –û–Ω–æ–≤–ª–µ–Ω–∏–π –∫–ª—é—á –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –º–æ–≤–∏
        const DEFAULT_LANG = 'uk';
        const MONTH_NAMES_UK = [
          '–°—ñ—á–µ–Ω—å', '–õ—é—Ç–∏–π', '–ë–µ—Ä–µ–∑–µ–Ω—å', '–ö–≤—ñ—Ç–µ–Ω—å', '–¢—Ä–∞–≤–µ–Ω—å', '–ß–µ—Ä–≤–µ–Ω—å',
          '–õ–∏–ø–µ–Ω—å', '–°–µ—Ä–ø–µ–Ω—å', '–í–µ—Ä–µ—Å–µ–Ω—å', '–ñ–æ–≤—Ç–µ–Ω—å', '–õ–∏—Å—Ç–æ–ø–∞–¥', '–ì—Ä—É–¥–µ–Ω—å'
        ];

        const SUPPORTED_LANGUAGES = [
            { code: 'uk', name: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞', dateLocale: 'uk-UA', currencyLocale: 'pl-PL', monthNames: MONTH_NAMES_UK },
            { code: 'en', name: 'English', dateLocale: 'en-US', currencyLocale: 'en-US', monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'] },
            { code: 'pl', name: 'Polski', dateLocale: 'pl-PL', currencyLocale: 'pl-PL', monthNames: ['Stycze≈Ñ', 'Luty', 'Marzec', 'Kwiecie≈Ñ', 'Maj', 'Czerwiec', 'Lipiec', 'Sierpie≈Ñ', 'Wrzesie≈Ñ', 'Pa≈∫dziernik', 'Listopad', 'Grudzie≈Ñ'] }
        ];

        const MESSAGES = {
            uk: {
                title: "–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –¢—Ä–µ–∫–µ—Ä",
                subtitle: "–î–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ –≤–∞—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó.",
                settings: "–ü–∞—Ä–∞–º–µ—Ç—Ä–∏",
                totalBalanceTitle: "–ó–∞–≥–∞–ª—å–Ω–∏–π –ë–∞–ª–∞–Ω—Å –∑–∞ –í–µ—Å—å –ß–∞—Å",
                totalIncome: "–ó–∞–≥–∞–ª—å–Ω–∏–π –î–æ—Ö—ñ–¥:",
                totalExpense: "–ó–∞–≥–∞–ª—å–Ω—ñ –í–∏—Ç—Ä–∞—Ç–∏:",
                addTransaction: "–î–æ–¥–∞—Ç–∏ –ù–æ–≤—É –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é",
                income: "–î–æ—Ö—ñ–¥ (+)",
                expense: "–í–∏—Ç—Ä–∞—Ç–∞ (-)",
                descriptionLabel: "–û–ø–∏—Å",
                descriptionPlaceholder: "–û—Ä–µ–Ω–¥–∞, –∑–∞—Ä–ø–ª–∞—Ç–∞, –∫–∞–≤–∞...",
                dateLabel: "–î–∞—Ç–∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó",
                amountLabel: "–°—É–º–∞ (PLN)",
                amountPlaceholder: "1000.00",
                addButton: "–î–æ–¥–∞—Ç–∏ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é",
                historyTitle: "–Ü—Å—Ç–æ—Ä—ñ—è –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π",
                noTransactions: "–ü–æ–∫–∏ —â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –Ω–µ–º–∞—î. –î–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à—É!",
                showAll: (count) => `–ü–æ–∫–∞–∑–∞—Ç–∏ –í—Å—ñ ${count} –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π`,
                hideAll: "–°—Ö–æ–≤–∞—Ç–∏ –ü–æ–≤–Ω—É –Ü—Å—Ç–æ—Ä—ñ—é",
                shownLast: (count) => `(–ü–æ–∫–∞–∑–∞–Ω–æ ${count} –æ—Å—Ç–∞–Ω–Ω—ñ—Ö)`,
                errorGeneric: "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –æ–ø–∏—Å —ñ —Å—É–º—É.",
                loadingError: "–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –°—Ö–æ–≤–∏—â–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—à–∫–æ–¥–∂–µ–Ω–µ.",
                exportTitle: "–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –†–µ–∑–µ—Ä–≤–Ω–µ –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è",
                importButton: "–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –î–∞–Ω—ñ (.json)",
                exportButton: "–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –î–∞–Ω—ñ (.json)",
                noDataExport: "–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É.",
                exportSuccess: "–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ.",
                importErrorInvalidFormat: "–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É. –û—á—ñ–∫—É—î—Ç—å—Å—è –º–∞—Å–∏–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.",
                importErrorNoValid: "–£ —Ñ–∞–π–ª—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∂–æ–¥–Ω–æ—ó –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.",
                importSuccess: (newCount, dupCount) => `–£—Å–ø—ñ—à–Ω–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ ${newCount} –Ω–æ–≤–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π. –ü—Ä–æ—ñ–≥–Ω–æ—Ä–æ–≤–∞–Ω–æ ${dupCount} –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ ID.`,
                chartTitle: (count) => `–ì—Ä–∞—Ñ—ñ–∫ –î–æ—Ö–æ–¥—ñ–≤ —Ç–∞ –í–∏—Ç—Ä–∞—Ç (–û—Å—Ç–∞–Ω–Ω—ñ ${count} –º—ñ—Å.)`,
                balance: "–ë–∞–ª–∞–Ω—Å:",
                detailedBreakdown: "–î–µ—Ç–∞–ª—å–Ω–∞ –ú—ñ—Å—è—á–Ω–∞ –†–æ–∑–±–∏–≤–∫–∞",
                month: "–ú—ñ—Å—è—Ü—å",
                noBreakdown: "–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–±–∏–≤–∫–∏.",
                unknownDate: "–ù–µ–≤—ñ–¥–æ–º–∞ –¥–∞—Ç–∞",
                languageSection: "–ú–æ–≤–∞ –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É",
                noDataChart: "–ù–µ–º–∞—î –î–æ—Ö–æ–¥—ñ–≤/–í–∏—Ç—Ä–∞—Ç",
                dataMessage: "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:"
            },
            en: {
                title: "Financial Tracker",
                subtitle: "Data is stored only on your device.",
                settings: "Settings",
                totalBalanceTitle: "Overall Balance for All Time",
                totalIncome: "Total Income:",
                totalExpense: "Total Expenses:",
                addTransaction: "Add New Transaction",
                income: "Income (+)",
                expense: "Expense (-)",
                descriptionLabel: "Description",
                descriptionPlaceholder: "Rent, salary, coffee...",
                dateLabel: "Transaction Date",
                amountLabel: "Amount (PLN)",
                amountPlaceholder: "1000.00",
                addButton: "Add Transaction",
                historyTitle: "Transaction History",
                noTransactions: "No transactions yet. Add the first one!",
                showAll: (count) => `Show All ${count} Transactions`,
                hideAll: "Hide Full History",
                shownLast: (count) => `(Shown ${count} latest)`,
                errorGeneric: "Please enter a valid description and amount.",
                loadingError: "Error loading local data. Storage may be corrupted.",
                exportTitle: "Settings and Backup",
                importButton: "Import Data (.json)",
                exportButton: "Export Data (.json)",
                noDataExport: "No data to export.",
                exportSuccess: "Data successfully exported.",
                importErrorInvalidFormat: "Invalid file format. Array of transactions is expected.",
                importErrorNoValid: "No valid transaction was found in the file.",
                importSuccess: (newCount, dupCount) => `Successfully imported ${newCount} new transactions. Ignored ${dupCount} ID duplicates.`,
                chartTitle: (count) => `Income and Expense Chart (Last ${count} months)`,
                balance: "Balance:",
                detailedBreakdown: "Detailed Monthly Breakdown",
                month: "Month",
                noBreakdown: "No data for breakdown.",
                unknownDate: "Unknown date",
                languageSection: "Interface Language",
                noDataChart: "No Income/Expense",
                dataMessage: "Message:"
            },
            pl: {
                title: "Tracker Finansowy",
                subtitle: "Dane sƒÖ przechowywane tylko na Twoim urzƒÖdzeniu.",
                settings: "Ustawienia",
                totalBalanceTitle: "Og√≥lne Saldo za Ca≈Çy Okres",
                totalIncome: "Ca≈Çkowity Doch√≥d:",
                totalExpense: "Ca≈Çkowite Wydatki:",
                addTransaction: "Dodaj NowƒÖ Transakcjƒô",
                income: "Doch√≥d (+)",
                expense: "Wydatek (-)",
                descriptionLabel: "Opis",
                descriptionPlaceholder: "Czynsz, wynagrodzenie, kawa...",
                dateLabel: "Data Transakcji",
                amountLabel: "Kwota (PLN)",
                amountPlaceholder: "1000.00",
                addButton: "Dodaj Transakcjƒô",
                historyTitle: "Historia Transakcji",
                noTransactions: "Brak transakcji. Dodaj pierwszƒÖ!",
                showAll: (count) => `Poka≈º Wszystkie ${count} Transakcje`,
                hideAll: "Ukryj Pe≈ÇnƒÖ Historiƒô",
                shownLast: (count) => `(Pokazano ${count} najnowszych)`,
                errorGeneric: "Proszƒô podaƒá poprawny opis i kwotƒô.",
                loadingError: "B≈ÇƒÖd ≈Çadowania danych lokalnych. Magazyn mo≈ºe byƒá uszkodzony.",
                exportTitle: "Ustawienia i Kopia Zapasowa",
                importButton: "Importuj Dane (.json)",
                exportButton: "Eksportuj Dane (.json)",
                noDataExport: "Brak danych do eksportu.",
                exportSuccess: "Dane pomy≈õlnie wyeksportowane.",
                importErrorInvalidFormat: "Nieprawid≈Çowy format pliku. Oczekiwana jest tablica transakcji.",
                importErrorNoValid: "Nie znaleziono ≈ºadnej poprawnej transakcji w pliku.",
                importSuccess: (newCount, dupCount) => `Pomy≈õlnie zaimportowano ${newCount} nowych transakcji. Zignorowano ${dupCount} duplikat√≥w ID.`,
                chartTitle: (count) => `Wykres Dochod√≥w i Wydatk√≥w (Ostatnie ${count} mies.)`,
                balance: "Saldo:",
                detailedBreakdown: "Szczeg√≥≈Çowe Zestawienie Miesiƒôczne",
                month: "MiesiƒÖc",
                noBreakdown: "Brak danych do zestawienia.",
                unknownDate: "Nieznana data",
                languageSection: "Jƒôzyk Interfejsu",
                noDataChart: "Brak Dochod√≥w/Wydatk√≥w",
                dataMessage: "Wiadomo≈õƒá:"
            }
        };
        
        // --- –î–û–ü–û–ú–Ü–ñ–ù–Ü –§–£–ù–ö–¶–Ü–á –¢–ê –ö–û–ú–ü–û–ù–ï–ù–¢–ò ---
        
        const getTodayDate = () => {
          const today = new Date();
          const year = today.getFullYear();
          const month = String(today.getMonth() + 1).padStart(2, '0');
          const day = String(today.getDate()).padStart(2, '0');
          return `${year}-${month}-${day}`;
        };
        
        const generateUniqueId = () => crypto.randomUUID(); 

        // –û–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—é—Ç–∏, –ø—Ä–∏–π–º–∞—î –ª–æ–∫–µ–ª—å
        const formatCurrency = (value, locale) => {
            return new Intl.NumberFormat(locale, {
              style: 'currency',
              currency: 'PLN', // –ó–∞–ª–∏—à–∞—î–º–æ PLN —è–∫ –≤–∞–ª—é—Ç—É
              maximumFractionDigits: 2
            }).format(value);
        };

        const PieChart = ({ income, expense, messages }) => {
            const total = income + expense;
            if (total === 0) return (
              <div className="text-gray-400 flex flex-col items-center justify-center py-4">
                <p className="text-4xl mb-1">üìä</p>
                <p className="text-xs font-medium">{messages.noDataChart}</p>
              </div>
            );

            const expensePercent = (expense / total) * 100;
            const dashArrayValue = `${expensePercent} ${100 - expensePercent}`;
            const incomeDashArrayValue = `${100 - expensePercent} ${expensePercent}`;

            return (
                <div className="w-full flex justify-center items-center">
                    <svg viewBox="0 0 36 36" className="w-24 h-24 sm:w-32 sm:h-32 transform -rotate-90">
                        {/* Background circle */}
                        <circle
                            cx="18" cy="18" r="15.91549430918954"
                            fill="transparent"
                            stroke="#e5e7eb" /* gray-200 */
                            strokeWidth="3.8"
                        />
                        {/* Expense segment (Red) */}
                        <circle
                            cx="18" cy="18" r="15.91549430918954"
                            fill="transparent"
                            stroke="#ef4444" /* red-500 */
                            strokeWidth="3.8"
                            strokeDasharray={dashArrayValue}
                            strokeDashoffset="0"
                            style={{ transition: 'stroke-dasharray 0.5s ease 0s' }}
                        />
                        {/* Income segment (Green) - starts where Expense ends */}
                        <circle
                            cx="18" cy="18" r="15.91549430918954"
                            fill="transparent"
                            stroke="#10b981" /* green-500 */
                            strokeWidth="3.8"
                            strokeDasharray={incomeDashArrayValue}
                            strokeDashoffset={-expensePercent} /* Start after expense */
                            style={{ transition: 'stroke-dasharray 0.5s ease 0s' }}
                        />
                    </svg>
                </div>
            );
        };


        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –º—ñ—Å—è—á–Ω–æ–≥–æ –≥—Ä–∞—Ñ—ñ–∫–∞
        const MonthlyChart = ({ summary, formatCurrency, locale, monthNames, messages }) => {
          if (summary.length === 0) return null;

          const recentSummary = summary.sort((a, b) => b.monthYear.localeCompare(a.monthYear)).slice(0, 6).reverse();
          const maxAbsValue = Math.max(...recentSummary.map(m => Math.max(m.income, m.expense, 1))); 

          return (
            <div className="bg-white shadow-lg rounded-2xl p-6 mb-8">
              <h2 className="text-xl font-bold text-gray-800 mb-4">{messages.chartTitle(recentSummary.length)}</h2>
              <div className="flex flex-col space-y-4">
                {recentSummary.map((m) => {
                  const monthIndex = parseInt(m.monthYear.substring(5, 7)) - 1;
                  const monthName = monthNames[monthIndex];
                  const year = m.monthYear.substring(0, 4);
                  const incomePercent = (m.income / maxAbsValue) * 100;
                  const expensePercent = (m.expense / maxAbsValue) * 100;
                  const monthBalance = m.income - m.expense;
                  
                  return (
                    <div key={m.monthYear} className="flex flex-col">
                      <div className="flex justify-between items-center text-sm font-medium mb-1">
                        <span className="text-gray-600">{monthName} {year}</span>
                        <span className={`font-semibold ${monthBalance >= 0 ? 'text-indigo-600' : 'text-red-600'}`}>
                            {messages.balance} {formatCurrency(monthBalance, locale)}
                        </span>
                      </div>

                      <div className="flex h-4 rounded-lg overflow-hidden bg-gray-200">
                        <div 
                          style={{ width: `${incomePercent}%` }} 
                          className="bg-green-500 transition-all duration-500 ease-out" 
                          title={`–î–æ—Ö—ñ–¥: ${formatCurrency(m.income, locale)}`}
                        />
                        <div 
                          style={{ width: `${expensePercent}%` }}
                          className="bg-red-500 transition-all duration-500 ease-out" 
                          title={`–í–∏—Ç—Ä–∞—Ç–∏: ${formatCurrency(m.expense, locale)}`}
                        />
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          );
        };

        const App = () => {
          // --- –°—Ç–∞–Ω –î–æ–¥–∞—Ç–∫—É ---
          const [transactions, setTransactions] = useState([]);
          const [error, setError] = useState(null);
          const [isSettingsOpen, setIsSettingsOpen] = useState(false); 
          const [showAllTransactions, setShowAllTransactions] = useState(false);
          const [currentLang, setCurrentLang] = useState(DEFAULT_LANG); // –°–¢–ê–ù –º–æ–≤–∏
          const [newTransaction, setNewTransaction] = useState({
            description: '',
            amount: '',
            type: 'expense', 
            date: getTodayDate()
          });

          const fileInputRef = useRef(null);

          // –í–∏–∑–Ω–∞—á–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π –Ω–∞–±—ñ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Ç–∞ –ª–æ–∫–µ–ª—ñ
          const messages = MESSAGES[currentLang] || MESSAGES[DEFAULT_LANG];
          const currentLangConfig = SUPPORTED_LANGUAGES.find(l => l.code === currentLang) || SUPPORTED_LANGUAGES[0];
          const currentLocale = currentLangConfig.currencyLocale;
          const currentDateLocale = currentLangConfig.dateLocale;
          const currentMonthNames = currentLangConfig.monthNames;

          // 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Local Storage –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ (—Ç–µ–ø–µ—Ä –≤–∫–ª—é—á–∞—î –º–æ–≤—É)
          useEffect(() => {
            const loadData = () => {
                try {
                    const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
                    if (storedData) {
                        const parsedData = JSON.parse(storedData);
                        
                        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–≤–∏
                        const loadedLang = parsedData.lang;
                        if (SUPPORTED_LANGUAGES.some(l => l.code === loadedLang)) {
                            setCurrentLang(loadedLang);
                        }

                        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
                        const loadedTransactions = parsedData.transactions || [];
                        const loaded = loadedTransactions.map(t => ({
                            ...t,
                            amount: parseFloat(t.amount), 
                            timestamp: new Date(t.date || t.timestamp), // –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å—Ç–∞—Ä–∏—Ö/–Ω–æ–≤–∏—Ö –∫–ª—é—á—ñ–≤
                        }));

                        const validTransactions = loaded.filter(t => 
                            !isNaN(t.amount) && t.amount > 0 && 
                            ['income', 'expense'].includes(t.type) &&
                            !isNaN(t.timestamp.getTime())
                        );

                        setTransactions(validTransactions);
                        setError(null);
                    }
                } catch (e) {
                    console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ö–æ–≤–∏—â–∞:", e);
                    setError(messages.loadingError);
                }
            };
            loadData();
          }, []); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ–π –º–∞—Å–∏–≤, —â–æ–± –≤–∏–∫–æ–Ω—É–≤–∞–ª–æ—Å—å –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑

          // 2. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É Local Storage –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –ê–ë–û –º–æ–≤–∏
          useEffect(() => {
            try {
                const serializableTransactions = transactions.map(t => ({
                    id: t.id,
                    description: t.description,
                    amount: t.amount.toFixed(2), 
                    type: t.type,
                    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞—Ç—É —è–∫ ISO —Ä—è–¥–æ–∫ –¥–ª—è —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—ñ
                    timestamp: t.timestamp.toISOString(),
                }));
                
                const dataToSave = {
                    transactions: serializableTransactions,
                    lang: currentLang,
                };
                
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(dataToSave));
                setError(null);
            } catch (e) {
                console.error("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –ª–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ:", e);
            }
          }, [transactions, currentLang]); // –î–æ–¥–∞–Ω–æ currentLang —è–∫ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å


          // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É —Ç–∞ –º—ñ—Å—è—á–Ω–∏—Ö –ø—ñ–¥—Å—É–º–∫—ñ–≤
          const { totalBalance, monthlySummary, totalIncome, totalExpense } = useMemo(() => {
            let balance = 0;
            let income = 0;
            let expense = 0;
            const monthlyData = {};

            transactions.forEach(t => {
              const amount = parseFloat(t.amount) || 0; 
              
              if (t.type === 'income') {
                balance += amount;
                income += amount;
              } else {
                balance -= amount;
                expense += amount;
              }

              const date = t.timestamp;
              if (isNaN(date.getTime())) return; 
              
              const year = date.getFullYear();
              const month = String(date.getMonth() + 1).padStart(2, '0'); 
              const monthYear = `${year}-${month}`;

              if (!monthlyData[monthYear]) {
                monthlyData[monthYear] = { 
                  income: 0, 
                  expense: 0, 
                  monthYear,
                };
              }

              if (t.type === 'income') {
                monthlyData[monthYear].income += amount;
              } else {
                monthlyData[monthYear].expense += amount;
              }
            });

            const sortedMonthlySummary = Object.values(monthlyData).sort((a, b) => {
              return b.monthYear.localeCompare(a.monthYear);
            });

            return { 
              totalBalance: balance, 
              monthlySummary: sortedMonthlySummary,
              totalIncome: income,
              totalExpense: expense,
            };
          }, [transactions]);


          // –û–±—Ä–æ–±–Ω–∏–∫ —Ñ–æ—Ä–º–∏
          const handleInputChange = (e) => {
            const { name, value } = e.target;
            setNewTransaction(prev => ({ ...prev, [name]: value }));
          };

          const handleSubmit = useCallback((e) => {
            e.preventDefault();

            const { description, amount, type, date } = newTransaction; 

            const parsedAmount = parseFloat(amount);
            if (!description.trim() || parsedAmount <= 0 || isNaN(parsedAmount)) {
              setError(messages.errorGeneric);
              return;
            }

            const newId = generateUniqueId();

            const transactionData = {
                id: newId,
                description: description.trim(),
                amount: parsedAmount,
                type,
                timestamp: new Date(date), 
            };

            setTransactions(prev => [transactionData, ...prev]); 
            
            setNewTransaction({ description: '', amount: '', type: 'expense', date: getTodayDate() }); 
            setError(null);
            
          }, [newTransaction, messages.errorGeneric]);

          const handleDelete = useCallback((id) => {
            setTransactions(prev => prev.filter(t => t.id !== id));
            setError(null);
          }, []);

          // --- –§–£–ù–ö–¶–Ü–Ø –ó–ú–Ü–ù–ò –ú–û–í–ò ---
          const handleLanguageChange = (code) => {
            setCurrentLang(code);
            setIsSettingsOpen(false); 
          };


          // --- –§–£–ù–ö–¶–Ü–Ø –ï–ö–°–ü–û–†–¢–£ –î–ê–ù–ò–• –£ JSON ---
          const handleExport = () => {
              if (transactions.length === 0) {
                  setError(messages.noDataExport);
                  return;
              }
              
              const dataToExport = transactions.map(t => ({
                  id: t.id,
                  description: t.description,
                  amount: t.amount.toFixed(2), 
                  type: t.type,
                  date: t.timestamp.toISOString(), 
              }));
              
              const json = JSON.stringify(dataToExport, null, 2);
              const blob = new Blob([json], { type: 'application/json' });
              const url = URL.createObjectURL(blob);
              
              const a = document.createElement('a');
              a.href = url;
              a.download = `finance_tracker_export_${new Date().toISOString().slice(0, 10)}.json`;
              document.body.appendChild(a);
              a.click();
              
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
              setError(messages.exportSuccess);
              setIsSettingsOpen(false);
          };

          // --- –§–£–ù–ö–¶–Ü–Ø –Ü–ú–ü–û–†–¢–£ –î–ê–ù–ò–• –ó JSON ---
          const handleImport = (event) => {
              const file = event.target.files[0];
              if (!file) return;

              const reader = new FileReader();
              reader.onload = (e) => {
                  try {
                      const importedJson = JSON.parse(e.target.result);
                      
                      if (!Array.isArray(importedJson)) {
                          throw new Error(messages.importErrorInvalidFormat);
                      }

                      let importCount = 0;
                      const newTransactions = importedJson.map(t => {
                          const amount = parseFloat(t.amount);
                          // –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –æ–±–æ—Ö –∫–ª—é—á—ñ–≤ –¥–∞—Ç–∏ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
                          const date = new Date(t.date || t.timestamp); 
                          const id = t.id || generateUniqueId();

                          if (
                              t.description && 
                              !isNaN(amount) && amount > 0 && 
                              ['income', 'expense'].includes(t.type) &&
                              !isNaN(date.getTime())
                          ) {
                              importCount++;
                              return {
                                  id: id,
                                  description: String(t.description).trim(),
                                  amount: amount, 
                                  type: t.type,
                                  timestamp: date, 
                              };
                          } else {
                              console.warn("–ü—Ä–æ–ø—É—â–µ–Ω–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é:", t);
                              return null; 
                          }
                      }).filter(t => t !== null); 

                      if (importCount === 0) {
                          throw new Error(messages.importErrorNoValid);
                      }
                      
                      const existingIds = new Set(transactions.map(t => t.id));
                      const uniqueNewTransactions = newTransactions.filter(t => !existingIds.has(t.id));
                      
                      const combinedTransactions = [...transactions, ...uniqueNewTransactions]
                        .sort((a, b) => b.timestamp - a.timestamp); 

                      setTransactions(combinedTransactions);
                      setError(messages.importSuccess(uniqueNewTransactions.length, newTransactions.length - uniqueNewTransactions.length));
                      
                  } catch (e) {
                      const errorMessage = e.message.startsWith('–ü–æ–º–∏–ª–∫–∞ —ñ–º–ø–æ—Ä—Ç—É') || e.message.startsWith('Import Error') || e.message.startsWith('B≈ÇƒÖd importu')
                        ? e.message
                        : `${messages.dataMessage}: ${e.message || "–ù–µ–º–æ–∂–ª–∏–≤–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ñ–∞–π–ª JSON."}`;

                      setError(errorMessage);
                  } finally {
                      setIsSettingsOpen(false);
                  }
              };

              reader.readAsText(file);
              event.target.value = null; 
          };

          const triggerFileSelect = () => {
            fileInputRef.current && fileInputRef.current.click();
          };

          const transactionsToDisplay = showAllTransactions 
            ? transactions 
            : transactions.slice(0, 10);
          const shouldShowToggleButton = transactions.length > 10;


          return (
            <div className="min-h-screen bg-gray-100 p-4 sm:p-6 font-sans">
              
              <input
                type="file"
                ref={fileInputRef}
                onChange={handleImport}
                accept=".json"
                className="hidden"
              />

              <div className="max-w-xl mx-auto">
                
                {/* --- HEADER –ó –ö–ù–û–ü–ö–û–Æ –ü–ê–†–ê–ú–ï–¢–†–Ü–í –£ –ü–†–ê–í–û–ú–£ –ö–£–¢–Ü --- */}
                <header className="text-center mb-6 relative">
                  <h1 className="text-3xl font-bold text-gray-800 mb-1">{messages.title}</h1>
                  <p className="text-sm text-indigo-600 font-medium">{messages.subtitle}</p>

                    {/* –ö–Ω–æ–ø–∫–∞ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ (–¢—Ä–∏ –ö—Ä–∞–ø–∫–∏) */}
                    <button
                        onClick={() => setIsSettingsOpen(true)}
                        className="absolute top-0 right-0 p-2 rounded-full text-indigo-600 hover:bg-gray-200 transition duration-150 text-2xl font-bold leading-none"
                        aria-label={messages.settings}
                    >
                        ...
                    </button>
                </header>

                {error && (
                  <div className="p-4 mb-4 text-sm rounded-lg border bg-red-100 text-red-800 border-red-300" role="alert">
                    <p className="font-semibold mb-1">{messages.dataMessage}</p>
                    <p className="font-mono text-xs break-all whitespace-pre-wrap">{error}</p>
                  </div>
                )}

                {/* --- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ü–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ --- */}
                {isSettingsOpen && (
                    <div className="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl relative animate-in zoom-in-50 duration-300">
                            <h3 className="text-xl font-bold text-gray-800 mb-6">{messages.exportTitle}</h3>
                            
                            <button
                                onClick={() => setIsSettingsOpen(false)}
                                className="absolute top-4 right-4 p-1 rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition"
                                aria-label="–ó–∞–∫—Ä–∏—Ç–∏"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>

                            <div className="space-y-6">
                                {/* –°–µ–∫—Ü—ñ—è –ú–æ–≤–∏ */}
                                <div>
                                    <h4 className="text-lg font-semibold text-gray-700 mb-3">{messages.languageSection}</h4>
                                    <div className="space-y-2">
                                        {SUPPORTED_LANGUAGES.map(lang => (
                                            <button
                                                key={lang.code}
                                                onClick={() => handleLanguageChange(lang.code)}
                                                className={`w-full text-left py-2 px-4 rounded-lg transition duration-150 ${
                                                    currentLang === lang.code 
                                                        ? 'bg-indigo-600 text-white shadow-md font-semibold' 
                                                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                                }`}
                                            >
                                                {lang.name}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* –°–µ–∫—Ü—ñ—è –ï–∫—Å–ø–æ—Ä—Ç—É/–Ü–º–ø–æ—Ä—Ç—É */}
                                <div className="pt-4 border-t border-gray-200 space-y-4">
                                    <button
                                        onClick={triggerFileSelect}
                                        className="w-full py-3 px-4 rounded-lg text-base font-medium transition duration-150 transform hover:scale-[1.01] shadow-md bg-gray-200 text-gray-800 hover:bg-gray-300"
                                    >
                                        {messages.importButton}
                                    </button>
                                    
                                    <button
                                        onClick={handleExport}
                                        disabled={transactions.length === 0}
                                        className={`w-full py-3 px-4 rounded-lg text-base font-medium transition duration-150 transform hover:scale-[1.01] shadow-md ${transactions.length === 0 ? 'bg-gray-400 text-white cursor-not-allowed' : 'bg-indigo-600 text-white hover:bg-indigo-700'}`}
                                    >
                                        {messages.exportButton}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                )}


                {/* –ö–∞—Ä—Ç–∫–∞ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É + –î—ñ–∞–≥—Ä–∞–º–∞ */}
                <div className="bg-white shadow-xl rounded-2xl p-6 mb-8 border-t-4 border-indigo-500">
                  <h2 className="text-lg font-semibold text-gray-700 mb-4">{messages.totalBalanceTitle}</h2>
                  <div className="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-6">
                      {/* 1. –ë–∞–ª–∞–Ω—Å */}
                      <div className="flex-1 min-w-0 w-full">
                          <p className={`text-4xl font-extrabold ${totalBalance >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                              {formatCurrency(totalBalance, currentLocale)}
                          </p>
                          <div className="mt-4 text-sm font-medium">
                              <div className="flex justify-between text-green-500 mb-1">
                                  <span>{messages.totalIncome}</span> 
                                  <span className="font-semibold">{formatCurrency(totalIncome, currentLocale)}</span>
                              </div>
                              <div className="flex justify-between text-red-500">
                                  <span>{messages.totalExpense}</span>
                                  <span className="font-semibold">{formatCurrency(totalExpense, currentLocale)}</span>
                              </div>
                          </div>
                      </div>

                      {/* 2. –ö—Ä—É–≥–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ */}
                      <div className="flex-shrink-0 w-32 h-32 flex items-center justify-center">
                          <PieChart income={totalIncome} expense={totalExpense} messages={messages} />
                      </div>
                  </div>
                </div>

                {/* –ì—Ä–∞—Ñ—ñ–∫ –ø–æ –º—ñ—Å—è—Ü—è—Ö */}
                <MonthlyChart 
                    summary={monthlySummary} 
                    formatCurrency={formatCurrency} 
                    locale={currentLocale} 
                    monthNames={currentMonthNames}
                    messages={messages}
                />

                {/* –§–æ—Ä–º–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó */}
                <div className="bg-white shadow-lg rounded-2xl p-6 mb-8">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">{messages.addTransaction}</h2>
                  <form onSubmit={handleSubmit} className="space-y-4">
                    {/* –í–∏–±—ñ—Ä —Ç–∏–ø—É */}
                    <div className="flex space-x-4">
                      <label className={`flex-1 p-3 text-center rounded-lg cursor-pointer transition duration-200 ${newTransaction.type === 'income' ? 'bg-green-100 border-2 border-green-500 text-green-700 font-semibold' : 'bg-gray-50 border border-gray-300 text-gray-600'}`}>
                        <input type="radio" name="type" value="income" checked={newTransaction.type === 'income'} onChange={handleInputChange} className="hidden" />
                        {messages.income}
                      </label>
                      <label className={`flex-1 p-3 text-center rounded-lg cursor-pointer transition duration-200 ${newTransaction.type === 'expense' ? 'bg-red-100 border-2 border-red-500 text-red-700 font-semibold' : 'bg-gray-50 border border-gray-300 text-gray-600'}`}>
                        <input type="radio" name="type" value="expense" checked={newTransaction.type === 'expense'} onChange={handleInputChange} className="hidden" />
                        {messages.expense}
                      </label>
                    </div>

                    {/* –û–ø–∏—Å */}
                    <div>
                      <label htmlFor="description" className="block text-sm font-medium text-gray-700 mb-1">{messages.descriptionLabel}</label>
                      <input type="text" id="description" name="description" value={newTransaction.description} onChange={handleInputChange} placeholder={messages.descriptionPlaceholder} required className="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" />
                    </div>
                    
                    {/* –î–∞—Ç–∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó */}
                    <div>
                      <label htmlFor="date" className="block text-sm font-medium text-gray-700 mb-1">{messages.dateLabel}</label>
                      <input type="date" id="date" name="date" value={newTransaction.date} onChange={handleInputChange} required className="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" />
                    </div>

                    {/* –°—É–º–∞ */}
                    <div>
                      <label htmlFor="amount" className="block text-sm font-medium text-gray-700 mb-1">{messages.amountLabel}</label>
                      <input type="number" id="amount" name="amount" value={newTransaction.amount} onChange={handleInputChange} placeholder={messages.amountPlaceholder} required min="0.01" step="0.01" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" />
                    </div>

                    {/* –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è */}
                    <button type="submit" className="w-full py-3 px-4 border border-transparent rounded-lg shadow-md text-base font-medium text-white transition duration-150 transform hover:scale-[1.01] bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                      {messages.addButton}
                    </button>
                  </form>
                </div>
                
                {/* –ú—ñ—Å—è—á–Ω–∞ —Ä–æ–∑–±–∏–≤–∫–∞ (–î–µ—Ç–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è) */}
                <div className="bg-white shadow-lg rounded-2xl p-6 mb-8">
                    <h2 className="text-xl font-bold text-gray-800 mb-4">{messages.detailedBreakdown}</h2>
                    {monthlySummary.length === 0 ? (
                        <p className="text-gray-500 text-center py-2">{messages.noBreakdown}</p>
                    ) : (
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{messages.month}</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">{messages.income}</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">{messages.expense}</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">{messages.balance}</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {monthlySummary.map(m => {
                                        const monthIndex = parseInt(m.monthYear.substring(5, 7)) - 1;
                                        const monthName = currentMonthNames[monthIndex];
                                        const year = m.monthYear.substring(0, 4);
                                        const monthBalance = m.income - m.expense;
                                        return (
                                            <tr key={m.monthYear} className="hover:bg-indigo-50 transition duration-150">
                                                <td className="px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900">{monthName} {year}</td>
                                                <td className="px-3 py-3 whitespace-nowrap text-sm text-green-600 text-right">{formatCurrency(m.income, currentLocale)}</td>
                                                <td className="px-3 py-3 whitespace-nowrap text-sm text-red-600 text-right">{formatCurrency(m.expense, currentLocale)}</td>
                                                <td className={`px-3 py-3 whitespace-nowrap text-sm font-bold text-right ${monthBalance >= 0 ? 'text-indigo-600' : 'text-red-600'}`}>
                                                    {formatCurrency(monthBalance, currentLocale)}
                                                </td>
                                            </tr>
                                        )
                                    })}
                                </tbody>
                            </table>
                        </div>
                    )}
                </div>

                {/* –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π */}
                <div className="bg-white shadow-lg rounded-2xl p-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">
                    {messages.historyTitle} ({transactions.length})
                    {shouldShowToggleButton && !showAllTransactions && (
                      <span className="text-sm text-gray-500 ml-2 font-normal"> {messages.shownLast(transactionsToDisplay.length)}</span>
                    )}
                  </h2>

                  {transactions.length === 0 ? (
                    <p className="text-gray-500 text-center py-4">{messages.noTransactions}</p>
                  ) : (
                    <ul className="space-y-3">
                      {transactionsToDisplay.map(t => (
                        <li
                          key={t.id}
                          className={`flex justify-between items-center p-4 rounded-xl shadow-sm transition duration-150 ease-in-out border-l-4 ${
                            t.type === 'income' ? 'border-green-500 bg-green-50 hover:bg-green-100' : 'border-red-500 bg-red-50 hover:bg-red-100'
                          }`}
                        >
                          {/* –û–ø–∏—Å —ñ –¥–∞—Ç–∞ */}
                          <div className="flex-1 min-w-0 pr-4">
                            <p className="font-semibold text-gray-800 truncate">{t.description}</p>
                            <p className="text-xs text-gray-500 mt-0.5">
                              {t.timestamp instanceof Date && !isNaN(t.timestamp) 
                                ? t.timestamp.toLocaleDateString(currentDateLocale, { year: 'numeric', month: 'long', day: 'numeric' })
                                : messages.unknownDate}
                            </p>
                          </div>

                          {/* –°—É–º–∞ */}
                          <div className="text-right flex items-center">
                            <span className={`font-bold text-lg mr-4 ${t.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                              {t.type === 'income' ? '+' : '-'}{formatCurrency(t.amount, currentLocale)}
                            </span>
                            {/* –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è */}
                            <button
                              onClick={() => handleDelete(t.id)}
                              className="p-1 rounded-full transition duration-150 focus:outline-none focus:ring-2 focus:ring-red-500 text-gray-400 hover:text-red-600"
                              aria-label="–í–∏–¥–∞–ª–∏—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é"
                            >
                              <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                              </svg>
                            </button>
                          </div>
                        </li>
                      ))}
                    </ul>
                  )}

                  {/* –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ø–æ–≤–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó */}
                  {shouldShowToggleButton && (
                      <button
                          onClick={() => setShowAllTransactions(prev => !prev)}
                          className="mt-6 w-full py-2 px-4 border border-transparent rounded-lg text-sm font-medium text-indigo-600 bg-indigo-50 hover:bg-indigo-100 transition duration-150 shadow-md"
                      >
                          {showAllTransactions 
                              ? messages.hideAll
                              : messages.showAll(transactions.length)
                          }
                      </button>
                  )}
                </div>
              </div>
            </div>
          );
        };
        
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        // --- –õ–û–ì–Ü–ö–ê –†–ï–Ñ–°–¢–†–ê–¶–Ü–á –°–ï–†–í–Ü–°-–í–û–†–ö–ï–†–ê (–∑–∞–ª–∏—à–∞—î–º–æ –¥–ª—è PWA) ---
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
                .then(registration => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, err => {
                    console.log('ServiceWorker registration failed: ', err);
                });
        }
    </script>
</body>
</html>
