<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú—ñ–π –õ–æ–∫–∞–ª—å–Ω–∏–π –§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –¢—Ä–µ–∫–µ—Ä</title>
    
    <!-- PWA —Ç–∞ –ú–∞–Ω—ñ—Ñ–µ—Å—Ç (–∑–∞–ª–∏—à–∞—î–º–æ –¥–ª—è –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è) -->
    <link rel="manifest" href="./finance_manifest.json">
    <meta name="theme-color" content="#4F46E5">

    <!-- CDN –¥–ª—è React, Babel —Ç–∞ Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* –°—Ç–∏–ª—ñ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —à—Ä–∏—Ñ—Ç—É */
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, useRef } = React;
        
        // --- –î–û–ü–û–ú–Ü–ñ–ù–Ü –§–£–ù–ö–¶–Ü–á –¢–ê –ö–û–ù–°–¢–ê–ù–¢–ò ---
        
        const MONTH_NAMES = [
          '–°—ñ—á–µ–Ω—å', '–õ—é—Ç–∏–π', '–ë–µ—Ä–µ–∑–µ–Ω—å', '–ö–≤—ñ—Ç–µ–Ω—å', '–¢—Ä–∞–≤–µ–Ω—å', '–ß–µ—Ä–≤–µ–Ω—å',
          '–õ–∏–ø–µ–Ω—å', '–°–µ—Ä–ø–µ–Ω—å', '–í–µ—Ä–µ—Å–µ–Ω—å', '–ñ–æ–≤—Ç–µ–Ω—å', '–õ–∏—Å—Ç–æ–ø–∞–¥', '–ì—Ä—É–¥–µ–Ω—å'
        ];

        const getTodayDate = () => {
          const today = new Date();
          const year = today.getFullYear();
          const month = String(today.getMonth() + 1).padStart(2, '0');
          const day = String(today.getDate()).padStart(2, '0');
          return `${year}-${month}-${day}`;
        };
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —É–Ω—ñ–∫–∞–ª—å–Ω–æ–≥–æ ID (–¥–ª—è Local Storage)
        const generateUniqueId = () => crypto.randomUUID(); 

        const formatCurrency = (value) => {
            return new Intl.NumberFormat('pl-PL', {
              style: 'currency',
              currency: 'PLN',
              maximumFractionDigits: 2
            }).format(value);
        };

        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫—Ä—É–≥–æ–≤–æ—ó –¥—ñ–∞–≥—Ä–∞–º–∏
        const PieChart = ({ income, expense }) => {
            const total = income + expense;
            if (total === 0) return (
              <div className="text-gray-400 flex flex-col items-center justify-center py-4">
                <p className="text-4xl mb-1">üìä</p>
                <p className="text-xs font-medium">–ù–µ–º–∞—î –î–æ—Ö–æ–¥—ñ–≤/–í–∏—Ç—Ä–∞—Ç</p>
              </div>
            );

            // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤–∏—Ç—Ä–∞—Ç (expense) –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–æ—ó —Å—É–º–∏
            const expensePercent = (expense / total) * 100;
            
            // –ó–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è stroke-dasharray
            // –ü–µ—Ä—à–µ —á–∏—Å–ª–æ: –¥–æ–≤–∂–∏–Ω–∞ –¥—É–≥–∏ (–≤—ñ–¥—Å–æ—Ç–æ–∫ –≤–∏—Ç—Ä–∞—Ç)
            // –î—Ä—É–≥–µ —á–∏—Å–ª–æ: –¥–æ–≤–∂–∏–Ω–∞ –∑–∞–ª–∏—à–∫—É (–≤—ñ–¥—Å–æ—Ç–æ–∫ –¥–æ—Ö–æ–¥—É)
            const dashArrayValue = `${expensePercent} ${100 - expensePercent}`;
            const incomeDashArrayValue = `${100 - expensePercent} ${expensePercent}`;

            return (
                <div className="w-full flex justify-center items-center">
                    <svg viewBox="0 0 36 36" className="w-24 h-24 sm:w-32 sm:h-32 transform -rotate-90">
                        {/* Background circle */}
                        <circle
                            cx="18" cy="18" r="15.91549430918954"
                            fill="transparent"
                            stroke="#e5e7eb" /* gray-200 */
                            strokeWidth="3.8"
                        />

                        {/* Expense segment (Red) */}
                        <circle
                            cx="18" cy="18" r="15.91549430918954"
                            fill="transparent"
                            stroke="#ef4444" /* red-500 */
                            strokeWidth="3.8"
                            strokeDasharray={dashArrayValue}
                            strokeDashoffset="0"
                            style={{ transition: 'stroke-dasharray 0.5s ease 0s' }}
                        />

                        {/* Income segment (Green) - starts where Expense ends */}
                        <circle
                            cx="18" cy="18" r="15.91549430918954"
                            fill="transparent"
                            stroke="#10b981" /* green-500 */
                            strokeWidth="3.8"
                            strokeDasharray={incomeDashArrayValue}
                            strokeDashoffset={-expensePercent} /* Start after expense */
                            style={{ transition: 'stroke-dasharray 0.5s ease 0s' }}
                        />
                    </svg>
                </div>
            );
        };


        // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –º—ñ—Å—è—á–Ω–æ–≥–æ –≥—Ä–∞—Ñ—ñ–∫–∞
        const MonthlyChart = ({ summary, formatCurrency }) => {
          if (summary.length === 0) return null;

          // –§—ñ–ª—å—Ç—Ä—É—î–º–æ —Ç–∞ —Å–æ—Ä—Ç—É—î–º–æ –ª–∏—à–µ 6 –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –º—ñ—Å—è—Ü—ñ–≤
          const recentSummary = summary.sort((a, b) => b.monthYear.localeCompare(a.monthYear)).slice(0, 6).reverse();
          
          const maxAbsValue = Math.max(...recentSummary.map(m => Math.max(m.income, m.expense, 1))); // min 1 to avoid division by zero

          return (
            <div className="bg-white shadow-lg rounded-2xl p-6 mb-8">
              <h2 className="text-xl font-bold text-gray-800 mb-4">–ì—Ä–∞—Ñ—ñ–∫ –î–æ—Ö–æ–¥—ñ–≤ —Ç–∞ –í–∏—Ç—Ä–∞—Ç (–û—Å—Ç–∞–Ω–Ω—ñ {recentSummary.length} –º—ñ—Å.)</h2>
              <div className="flex flex-col space-y-4">
                {recentSummary.map((m) => {
                  const monthIndex = parseInt(m.monthYear.substring(5, 7)) - 1;
                  const monthName = MONTH_NAMES[monthIndex];
                  const year = m.monthYear.substring(0, 4);
                  // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —à–∏—Ä–∏–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è
                  const incomePercent = (m.income / maxAbsValue) * 100;
                  const expensePercent = (m.expense / maxAbsValue) * 100;
                  const monthBalance = m.income - m.expense;
                  
                  return (
                    <div key={m.monthYear} className="flex flex-col">
                      <div className="flex justify-between items-center text-sm font-medium mb-1">
                        <span className="text-gray-600">{monthName} {year}</span>
                        <span className={`font-semibold ${monthBalance >= 0 ? 'text-indigo-600' : 'text-red-600'}`}>
                            –ë–∞–ª–∞–Ω—Å: {formatCurrency(monthBalance)}
                        </span>
                      </div>

                      <div className="flex h-4 rounded-lg overflow-hidden bg-gray-200">
                        <div 
                          style={{ width: `${incomePercent}%` }} 
                          className="bg-green-500 transition-all duration-500 ease-out" 
                          title={`–î–æ—Ö—ñ–¥: ${formatCurrency(m.income)}`}
                        />
                        <div 
                          style={{ width: `${expensePercent}%` }}
                          className="bg-red-500 transition-all duration-500 ease-out" 
                          title={`–í–∏—Ç—Ä–∞—Ç–∏: ${formatCurrency(m.expense)}`}
                        />
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          );
        };

        const App = () => {
          // --- –°—Ç–∞–Ω –î–æ–¥–∞—Ç–∫—É ---
          const [transactions, setTransactions] = useState([]);
          const [error, setError] = useState(null);
          const [isSettingsOpen, setIsSettingsOpen] = useState(false); 
          const [showAllTransactions, setShowAllTransactions] = useState(false); // –°–¢–ê–ù –¥–ª—è –ø–æ–≤–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó
          const [newTransaction, setNewTransaction] = useState({
            description: '',
            amount: '',
            type: 'expense', 
            date: getTodayDate()
          });

          // –†–µ—Ñ–µ—Ä–µ–Ω—Å –¥–ª—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ —ñ–Ω–ø—É—Ç—É —Ñ–∞–π–ª—É
          const fileInputRef = useRef(null);
          
          const LOCAL_STORAGE_KEY = 'localFinanceTrackerData';

          // 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Local Storage –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
          useEffect(() => {
            const loadData = () => {
                try {
                    const storedTransactions = localStorage.getItem(LOCAL_STORAGE_KEY);
                    if (storedTransactions) {
                        // –ü–∞—Ä—Å–∏–Ω–≥ —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
                        const loaded = JSON.parse(storedTransactions).map(t => ({
                            ...t,
                            // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Å—É–º—É –Ω–∞ —á–∏—Å–ª–æ
                            amount: parseFloat(t.amount), 
                            // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Ä—è–¥–æ–∫ –¥–∞—Ç–∏ –Ω–∞ –æ–±'—î–∫—Ç Date
                            timestamp: new Date(t.timestamp), 
                        }));

                        // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
                        const validTransactions = loaded.filter(t => 
                            !isNaN(t.amount) && t.amount > 0 && 
                            ['income', 'expense'].includes(t.type) &&
                            !isNaN(t.timestamp.getTime())
                        );

                        setTransactions(validTransactions);
                        setError(null);

                        if (validTransactions.length !== loaded.length) {
                             console.warn("–î–µ—è–∫—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –±—É–ª–∏ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω—ñ —á–µ—Ä–µ–∑ –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö.");
                        }

                    }
                } catch (e) {
                    console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ö–æ–≤–∏—â–∞:", e);
                    setError("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –°—Ö–æ–≤–∏—â–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—à–∫–æ–¥–∂–µ–Ω–µ.");
                }
            };
            loadData();
          }, []); 

          // 2. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É Local Storage –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
          useEffect(() => {
            try {
                if (transactions.length > 0) {
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –æ–±'—î–∫—Ç–∞ Date –≤ ISO —Ä—è–¥–æ–∫ —Ç–∞ —Å—É–º–∏ –≤ —Ä—è–¥–æ–∫ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
                    const serializableTransactions = transactions.map(t => ({
                        ...t,
                        timestamp: t.timestamp.toISOString(),
                        amount: t.amount.toFixed(2), 
                    }));
                    localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(serializableTransactions));
                } else {
                    // –û—á–∏—â—É—î–º–æ, —è–∫—â–æ —Å–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π
                    localStorage.removeItem(LOCAL_STORAGE_KEY);
                }
                setError(null);
            } catch (e) {
                console.error("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –ª–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ:", e);
                // –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –±—ñ–ª—å—à –º'—è–∫–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
                // setError("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö. –°—Ö–æ–≤–∏—â–µ –ø—Ä–∏—Å—Ç—Ä–æ—é –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–µ –∞–±–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–µ.");
            }
          }, [transactions]);


          // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É —Ç–∞ –º—ñ—Å—è—á–Ω–∏—Ö –ø—ñ–¥—Å—É–º–∫—ñ–≤
          const { totalBalance, monthlySummary, totalIncome, totalExpense } = useMemo(() => {
            let balance = 0;
            let income = 0;
            let expense = 0;
            const monthlyData = {};

            transactions.forEach(t => {
              // –ü–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è, —â–æ t.amount —î —á–∏—Å–ª–æ–º
              const amount = parseFloat(t.amount) || 0; 
              
              if (t.type === 'income') {
                balance += amount;
                income += amount;
              } else {
                balance -= amount;
                expense += amount;
              }

              const date = t.timestamp;
              if (isNaN(date.getTime())) return; 
              
              const year = date.getFullYear();
              const month = String(date.getMonth() + 1).padStart(2, '0'); 
              const monthYear = `${year}-${month}`;

              if (!monthlyData[monthYear]) {
                monthlyData[monthYear] = { 
                  income: 0, 
                  expense: 0, 
                  monthYear,
                  monthName: MONTH_NAMES[date.getMonth()] 
                };
              }

              if (t.type === 'income') {
                monthlyData[monthYear].income += amount;
              } else {
                monthlyData[monthYear].expense += amount;
              }
            });

            const sortedMonthlySummary = Object.values(monthlyData).sort((a, b) => {
              return b.monthYear.localeCompare(a.monthYear);
            });

            return { 
              totalBalance: balance, 
              monthlySummary: sortedMonthlySummary,
              totalIncome: income,
              totalExpense: expense,
            };
          }, [transactions]);


          // –û–±—Ä–æ–±–Ω–∏–∫ —Ñ–æ—Ä–º–∏
          const handleInputChange = (e) => {
            const { name, value } = e.target;
            setNewTransaction(prev => ({ ...prev, [name]: value }));
          };

          const handleSubmit = useCallback((e) => {
            e.preventDefault();

            const { description, amount, type, date } = newTransaction; 

            const parsedAmount = parseFloat(amount);
            if (!description.trim() || parsedAmount <= 0 || isNaN(parsedAmount)) {
              setError("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π –æ–ø–∏—Å —ñ —Å—É–º—É.");
              return;
            }

            const newId = generateUniqueId();

            const transactionData = {
                id: newId,
                description: description.trim(),
                amount: parsedAmount, // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —è–∫ —á–∏—Å–ª–æ –≤ —Å—Ç–∞–Ω—ñ
                type,
                timestamp: new Date(date), 
            };

            // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ useEffect
            setTransactions(prev => [transactionData, ...prev]); 
            
            // –û—á–∏—â—É—î–º–æ —Ñ–æ—Ä–º—É
            setNewTransaction({ description: '', amount: '', type: 'expense', date: getTodayDate() }); 
            setError(null);
            
          }, [newTransaction]);

          const handleDelete = useCallback((id) => {
            // –§—ñ–ª—å—Ç—Ä—É—î–º–æ —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ –µ–ª–µ–º–µ–Ω—Ç –∑ –º–∞—Å–∏–≤—É
            setTransactions(prev => prev.filter(t => t.id !== id));
            setError(null);
          }, []);

          // --- –§–£–ù–ö–¶–Ü–Ø –ï–ö–°–ü–û–†–¢–£ –î–ê–ù–ò–• –£ JSON ---
          const handleExport = () => {
              if (transactions.length === 0) {
                  setError("–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É.");
                  return;
              }
              
              const dataToExport = transactions.map(t => ({
                  id: t.id,
                  description: t.description,
                  amount: t.amount.toFixed(2), 
                  type: t.type,
                  // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –æ–±'—î–∫—Ç Date –Ω–∞ ISO —Ä—è–¥–æ–∫ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ
                  date: t.timestamp.toISOString(), 
              }));
              
              const json = JSON.stringify(dataToExport, null, 2);
              const blob = new Blob([json], { type: 'application/json' });
              const url = URL.createObjectURL(blob);
              
              // –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
              const a = document.createElement('a');
              a.href = url;
              a.download = `finance_tracker_export_${new Date().toISOString().slice(0, 10)}.json`;
              document.body.appendChild(a);
              a.click();
              
              // –û—á–∏—â–µ–Ω–Ω—è
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
              setError("–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ.");
              setIsSettingsOpen(false); // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ
          };

          // --- –§–£–ù–ö–¶–Ü–Ø –Ü–ú–ü–û–†–¢–£ –î–ê–ù–ò–• –ó JSON ---
          const handleImport = (event) => {
              const file = event.target.files[0];
              if (!file) return;

              const reader = new FileReader();
              reader.onload = (e) => {
                  try {
                      const importedJson = JSON.parse(e.target.result);
                      
                      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –º–∞—Å–∏–≤
                      if (!Array.isArray(importedJson)) {
                          throw new Error("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É. –û—á—ñ–∫—É—î—Ç—å—Å—è –º–∞—Å–∏–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.");
                      }

                      // –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
                      let importCount = 0;
                      const newTransactions = importedJson.map(t => {
                          const amount = parseFloat(t.amount);
                          const date = new Date(t.date || t.timestamp); // –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –æ–±–æ—Ö –∫–ª—é—á—ñ–≤ –¥–∞—Ç–∏
                          const id = t.id || generateUniqueId();

                          // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏—Ö –≤–∏–º–æ–≥
                          if (
                              t.description && 
                              !isNaN(amount) && amount > 0 && 
                              ['income', 'expense'].includes(t.type) &&
                              !isNaN(date.getTime())
                          ) {
                              importCount++;
                              return {
                                  id: id,
                                  description: String(t.description).trim(),
                                  amount: amount, // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —è–∫ —á–∏—Å–ª–æ
                                  type: t.type,
                                  timestamp: date, // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —è–∫ –æ–±'—î–∫—Ç Date
                              };
                          } else {
                              console.warn("–ü—Ä–æ–ø—É—â–µ–Ω–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é:", t);
                              return null; // –ü–æ–∑–Ω–∞—á–∞—î–º–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é
                          }
                      }).filter(t => t !== null); // –í–∏–¥–∞–ª—è—î–º–æ –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ

                      if (importCount === 0) {
                          throw new Error("–£ —Ñ–∞–π–ª—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∂–æ–¥–Ω–æ—ó –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.");
                      }
                      
                      // –û–±'—î–¥–Ω–∞–Ω–Ω—è –∑ —ñ—Å–Ω—É—é—á–∏–º–∏ –¥–∞–Ω–∏–º–∏ —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –∑–∞ ID
                      const existingIds = new Set(transactions.map(t => t.id));
                      const uniqueNewTransactions = newTransactions.filter(t => !existingIds.has(t.id));
                      
                      // –°–æ—Ä—Ç—É—î–º–æ –∑–∞ —á–∞—Å–æ–º
                      const combinedTransactions = [...transactions, ...uniqueNewTransactions]
                        .sort((a, b) => b.timestamp - a.timestamp); 

                      setTransactions(combinedTransactions);
                      setError(`–£—Å–ø—ñ—à–Ω–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ ${uniqueNewTransactions.length} –Ω–æ–≤–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π. –ü—Ä–æ—ñ–≥–Ω–æ—Ä–æ–≤–∞–Ω–æ ${newTransactions.length - uniqueNewTransactions.length} –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ ID.`);
                      
                  } catch (e) {
                      console.error("–ü–æ–º–∏–ª–∫–∞ –æ–±—Ä–æ–±–∫–∏ —Ñ–∞–π–ª—É —ñ–º–ø–æ—Ä—Ç—É:", e);
                      setError(`–ü–æ–º–∏–ª–∫–∞ —ñ–º–ø–æ—Ä—Ç—É: ${e.message || "–ù–µ–º–æ–∂–ª–∏–≤–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ñ–∞–π–ª JSON."}`);
                  } finally {
                      setIsSettingsOpen(false); // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ
                  }
              };

              // –ß–∏—Ç–∞—î–º–æ —Ñ–∞–π–ª —è–∫ —Ç–µ–∫—Å—Ç
              reader.readAsText(file);
              
              // –°–∫–∏–¥–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω–ø—É—Ç—É, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π —Ñ–∞–π–ª –∑–Ω–æ–≤—É
              event.target.value = null; 
          };

          // –•–µ–Ω–¥–ª–µ—Ä –¥–ª—è –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É —ñ–º–ø–æ—Ä—Ç—É, —è–∫–∏–π –∞–∫—Ç–∏–≤—É—î –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π —ñ–Ω–ø—É—Ç
          const triggerFileSelect = () => {
            // –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å —ñ—Å–Ω—É—î, –ø–µ—Ä—à –Ω—ñ–∂ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ click()
            fileInputRef.current && fileInputRef.current.click();
          };

          // –õ–æ–≥—ñ–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
          const transactionsToDisplay = showAllTransactions 
            ? transactions 
            : transactions.slice(0, 10); // –ü–æ–∫–∞–∑—É—î–º–æ –ª–∏—à–µ 10 –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
          const shouldShowToggleButton = transactions.length > 10;


          return (
            <div className="min-h-screen bg-gray-100 p-4 sm:p-6 font-sans">
              
              {/* –ü—Ä–∏—Ö–æ–≤–∞–Ω–∏–π —ñ–Ω–ø—É—Ç –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É (–∑–∞–ª–∏—à–∞—î–º–æ —Ç—É—Ç, —â–æ–± –≤—ñ–Ω –±—É–≤ –∑–∞–≤–∂–¥–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π) */}
              <input
                type="file"
                ref={fileInputRef}
                onChange={handleImport}
                accept=".json"
                className="hidden"
              />

              <div className="max-w-xl mx-auto">
                
                {/* --- HEADER –ó –ö–ù–û–ü–ö–û–Æ –ü–ê–†–ê–ú–ï–¢–†–Ü–í –£ –ü–†–ê–í–û–ú–£ –ö–£–¢–Ü --- */}
                <header className="text-center mb-6 relative">
                  <h1 className="text-3xl font-bold text-gray-800 mb-1">–ú—ñ–π –õ–æ–∫–∞–ª—å–Ω–∏–π –§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –¢—Ä–µ–∫–µ—Ä</h1>
                  <p className="text-sm text-indigo-600 font-medium">–î–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ –≤–∞—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó.</p>

                    {/* –ö–Ω–æ–ø–∫–∞ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ (Gear Icon) - –ü–µ—Ä–µ–º—ñ—â–µ–Ω–æ —É –≤–µ—Ä—Ö–Ω—ñ–π –ø—Ä–∞–≤–∏–π –∫—É—Ç */}
                    <button
                        onClick={() => setIsSettingsOpen(true)}
                        className="absolute top-0 right-0 p-2 rounded-full text-indigo-600 hover:bg-gray-200 transition duration-150"
                        aria-label="–ü–∞—Ä–∞–º–µ—Ç—Ä–∏"
                    >
                        {/* Gear icon */}
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.44a2 2 0 0 1-1.38 1.84l-.65.25a2 2 0 0 0-1.12 3.42l.37.5a2 2 0 0 1-.36 2.05l-.4.57a2 2 0 0 0 .9 2.92l.65.25a2 2 0 0 1 1.38 1.84v.44a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.44a2 2 0 0 1 1.38-1.84l.65-.25a2 2 0 0 0 1.12-3.42l-.37-.5a2 2 0 0 1 .36-2.05l.4-.57a2 2 0 0 0-.9-2.92l-.65-.25a2 2 0 0 1-1.38-1.84V4a2 2 0 0 0-2-2z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                    </button>
                </header>

                {error && (
                  <div className="p-4 mb-4 text-sm rounded-lg border bg-red-100 text-red-800 border-red-300" role="alert">
                    <p className="font-semibold mb-1">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</p>
                    <p className="font-mono text-xs break-all whitespace-pre-wrap">{error}</p>
                  </div>
                )}

                {/* --- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ü–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ --- */}
                {isSettingsOpen && (
                    <div className="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl relative animate-in zoom-in-50 duration-300">
                            <h3 className="text-xl font-bold text-gray-800 mb-6">–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –†–µ–∑–µ—Ä–≤–Ω–µ –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è</h3>
                            
                            {/* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è */}
                            <button
                                onClick={() => setIsSettingsOpen(false)}
                                className="absolute top-4 right-4 p-1 rounded-full text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition"
                                aria-label="–ó–∞–∫—Ä–∏—Ç–∏"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>

                            <div className="space-y-4">
                                <button
                                    onClick={triggerFileSelect}
                                    className="w-full py-3 px-4 rounded-lg text-base font-medium transition duration-150 transform hover:scale-[1.01] shadow-md bg-gray-200 text-gray-800 hover:bg-gray-300"
                                >
                                    –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –î–∞–Ω—ñ (.json)
                                </button>
                                
                                <button
                                    onClick={handleExport}
                                    disabled={transactions.length === 0}
                                    className={`w-full py-3 px-4 rounded-lg text-base font-medium transition duration-150 transform hover:scale-[1.01] shadow-md ${transactions.length === 0 ? 'bg-gray-400 text-white cursor-not-allowed' : 'bg-indigo-600 text-white hover:bg-indigo-700'}`}
                                >
                                    –ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –î–∞–Ω—ñ (.json)
                                </button>
                            </div>
                        </div>
                    </div>
                )}


                {/* –ö–∞—Ä—Ç–∫–∞ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å—É + –î—ñ–∞–≥—Ä–∞–º–∞ */}
                <div className="bg-white shadow-xl rounded-2xl p-6 mb-8 border-t-4 border-indigo-500">
                  <h2 className="text-lg font-semibold text-gray-700 mb-4">–ó–∞–≥–∞–ª—å–Ω–∏–π –ë–∞–ª–∞–Ω—Å –∑–∞ –í–µ—Å—å –ß–∞—Å</h2>
                  <div className="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-6">
                      {/* 1. –ë–∞–ª–∞–Ω—Å */}
                      <div className="flex-1 min-w-0 w-full">
                          <p className={`text-4xl font-extrabold ${totalBalance >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                              {formatCurrency(totalBalance)}
                          </p>
                          <div className="mt-4 text-sm font-medium">
                              <div className="flex justify-between text-green-500 mb-1">
                                  <span>–ó–∞–≥–∞–ª—å–Ω–∏–π –î–æ—Ö—ñ–¥:</span> 
                                  <span className="font-semibold">{formatCurrency(totalIncome)}</span>
                              </div>
                              <div className="flex justify-between text-red-500">
                                  <span>–ó–∞–≥–∞–ª—å–Ω—ñ –í–∏—Ç—Ä–∞—Ç–∏:</span>
                                  <span className="font-semibold">{formatCurrency(totalExpense)}</span>
                              </div>
                          </div>
                      </div>

                      {/* 2. –ö—Ä—É–≥–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ */}
                      <div className="flex-shrink-0 w-32 h-32 flex items-center justify-center">
                          <PieChart income={totalIncome} expense={totalExpense} />
                      </div>
                  </div>
                </div>

                {/* –ì—Ä–∞—Ñ—ñ–∫ –ø–æ –º—ñ—Å—è—Ü—è—Ö */}
                <MonthlyChart summary={monthlySummary} formatCurrency={formatCurrency} />

                {/* –§–æ—Ä–º–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó */}
                <div className="bg-white shadow-lg rounded-2xl p-6 mb-8">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">–î–æ–¥–∞—Ç–∏ –ù–æ–≤—É –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é</h2>
                  <form onSubmit={handleSubmit} className="space-y-4">
                    {/* –í–∏–±—ñ—Ä —Ç–∏–ø—É */}
                    <div className="flex space-x-4">
                      <label className={`flex-1 p-3 text-center rounded-lg cursor-pointer transition duration-200 ${newTransaction.type === 'income' ? 'bg-green-100 border-2 border-green-500 text-green-700 font-semibold' : 'bg-gray-50 border border-gray-300 text-gray-600'}`}>
                        <input type="radio" name="type" value="income" checked={newTransaction.type === 'income'} onChange={handleInputChange} className="hidden" />
                        –î–æ—Ö—ñ–¥ (+)
                      </label>
                      <label className={`flex-1 p-3 text-center rounded-lg cursor-pointer transition duration-200 ${newTransaction.type === 'expense' ? 'bg-red-100 border-2 border-red-500 text-red-700 font-semibold' : 'bg-gray-50 border border-gray-300 text-gray-600'}`}>
                        <input type="radio" name="type" value="expense" checked={newTransaction.type === 'expense'} onChange={handleInputChange} className="hidden" />
                        –í–∏—Ç—Ä–∞—Ç–∞ (-)
                      </label>
                    </div>

                    {/* –û–ø–∏—Å */}
                    <div>
                      <label htmlFor="description" className="block text-sm font-medium text-gray-700 mb-1">–û–ø–∏—Å</label>
                      <input type="text" id="description" name="description" value={newTransaction.description} onChange={handleInputChange} placeholder="–û—Ä–µ–Ω–¥–∞, –∑–∞—Ä–ø–ª–∞—Ç–∞, –∫–∞–≤–∞..." required className="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" />
                    </div>
                    
                    {/* –î–∞—Ç–∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó */}
                    <div>
                      <label htmlFor="date" className="block text-sm font-medium text-gray-700 mb-1">–î–∞—Ç–∞ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó</label>
                      <input type="date" id="date" name="date" value={newTransaction.date} onChange={handleInputChange} required className="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" />
                    </div>

                    {/* –°—É–º–∞ */}
                    <div>
                      <label htmlFor="amount" className="block text-sm font-medium text-gray-700 mb-1">–°—É–º–∞ (PLN)</label>
                      <input type="number" id="amount" name="amount" value={newTransaction.amount} onChange={handleInputChange} placeholder="1000.00" required min="0.01" step="0.01" className="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150" />
                    </div>

                    {/* –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è */}
                    <button type="submit" className="w-full py-3 px-4 border border-transparent rounded-lg shadow-md text-base font-medium text-white transition duration-150 transform hover:scale-[1.01] bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                      –î–æ–¥–∞—Ç–∏ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é
                    </button>
                  </form>
                </div>
                
                {/* –ú—ñ—Å—è—á–Ω–∞ —Ä–æ–∑–±–∏–≤–∫–∞ (–î–µ—Ç–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è) */}
                <div className="bg-white shadow-lg rounded-2xl p-6 mb-8">
                    <h2 className="text-xl font-bold text-gray-800 mb-4">–î–µ—Ç–∞–ª—å–Ω–∞ –ú—ñ—Å—è—á–Ω–∞ –†–æ–∑–±–∏–≤–∫–∞</h2>
                    {monthlySummary.length === 0 ? (
                        <p className="text-gray-500 text-center py-2">–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è —Ä–æ–∑–±–∏–≤–∫–∏.</p>
                    ) : (
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">–ú—ñ—Å—è—Ü—å</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">–î–æ—Ö—ñ–¥</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">–í–∏—Ç—Ä–∞—Ç–∏</th>
                                        <th className="px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">–ë–∞–ª–∞–Ω—Å</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {monthlySummary.map(m => {
                                        const monthBalance = m.income - m.expense;
                                        return (
                                            <tr key={m.monthYear} className="hover:bg-indigo-50 transition duration-150">
                                                <td className="px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900">{m.monthName} {m.monthYear.substring(0, 4)}</td>
                                                <td className="px-3 py-3 whitespace-nowrap text-sm text-green-600 text-right">{formatCurrency(m.income)}</td>
                                                <td className="px-3 py-3 whitespace-nowrap text-sm text-red-600 text-right">{formatCurrency(m.expense)}</td>
                                                <td className={`px-3 py-3 whitespace-nowrap text-sm font-bold text-right ${monthBalance >= 0 ? 'text-indigo-600' : 'text-red-600'}`}>
                                                    {formatCurrency(monthBalance)}
                                                </td>
                                            </tr>
                                        )
                                    })}
                                </tbody>
                            </table>
                        </div>
                    )}
                </div>

                {/* –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π */}
                <div className="bg-white shadow-lg rounded-2xl p-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">
                    –Ü—Å—Ç–æ—Ä—ñ—è –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π ({transactions.length})
                    {shouldShowToggleButton && !showAllTransactions && (
                      <span className="text-sm text-gray-500 ml-2 font-normal"> (–ü–æ–∫–∞–∑–∞–Ω–æ {transactionsToDisplay.length} –æ—Å—Ç–∞–Ω–Ω—ñ—Ö)</span>
                    )}
                  </h2>

                  {transactions.length === 0 ? (
                    <p className="text-gray-500 text-center py-4">–ü–æ–∫–∏ —â–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –Ω–µ–º–∞—î. –î–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à—É!</p>
                  ) : (
                    <ul className="space-y-3">
                      {transactionsToDisplay.map(t => (
                        <li
                          key={t.id}
                          className={`flex justify-between items-center p-4 rounded-xl shadow-sm transition duration-150 ease-in-out border-l-4 ${
                            t.type === 'income' ? 'border-green-500 bg-green-50 hover:bg-green-100' : 'border-red-500 bg-red-50 hover:bg-red-100'
                          }`}
                        >
                          {/* –û–ø–∏—Å —ñ –¥–∞—Ç–∞ */}
                          <div className="flex-1 min-w-0 pr-4">
                            <p className="font-semibold text-gray-800 truncate">{t.description}</p>
                            <p className="text-xs text-gray-500 mt-0.5">
                              {/* –í—ñ–¥–æ–±—Ä–∞–∂–∞—î–º–æ –¥–∞—Ç—É —É —á–∏—Ç–∞–±–µ–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ */}
                              {t.timestamp instanceof Date && !isNaN(t.timestamp) 
                                ? t.timestamp.toLocaleDateString('uk-UA', { year: 'numeric', month: 'long', day: 'numeric' })
                                : '–ù–µ–≤—ñ–¥–æ–º–∞ –¥–∞—Ç–∞'}
                            </p>
                          </div>

                          {/* –°—É–º–∞ */}
                          <div className="text-right flex items-center">
                            <span className={`font-bold text-lg mr-4 ${t.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                              {t.type === 'income' ? '+' : '-'}{formatCurrency(t.amount)}
                            </span>
                            {/* –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è */}
                            <button
                              onClick={() => handleDelete(t.id)}
                              className="p-1 rounded-full transition duration-150 focus:outline-none focus:ring-2 focus:ring-red-500 text-gray-400 hover:text-red-600"
                              aria-label="–í–∏–¥–∞–ª–∏—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é"
                            >
                              <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                              </svg>
                            </button>
                          </div>
                        </li>
                      ))}
                    </ul>
                  )}

                  {/* –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ø–æ–≤–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó */}
                  {shouldShowToggleButton && (
                      <button
                          onClick={() => setShowAllTransactions(prev => !prev)}
                          className="mt-6 w-full py-2 px-4 border border-transparent rounded-lg text-sm font-medium text-indigo-600 bg-indigo-50 hover:bg-indigo-100 transition duration-150 shadow-md"
                      >
                          {showAllTransactions 
                              ? '–°—Ö–æ–≤–∞—Ç–∏ –ü–æ–≤–Ω—É –Ü—Å—Ç–æ—Ä—ñ—é' 
                              : `–ü–æ–∫–∞–∑–∞—Ç–∏ –í—Å—ñ ${transactions.length} –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π`
                          }
                      </button>
                  )}
                </div>
              </div>
            </div>
          );
        };
        
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        // --- –õ–û–ì–Ü–ö–ê –†–ï–Ñ–°–¢–†–ê–¶–Ü–á –°–ï–†–í–Ü–°-–í–û–†–ö–ï–†–ê (–∑–∞–ª–∏—à–∞—î–º–æ –¥–ª—è PWA) ---
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
                .then(registration => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, err => {
                    console.log('ServiceWorker registration failed: ', err);
                });
        }
    </script>
</body>
</html>
